!function(a,b){"use strict";"object"==typeof exports&&module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.PubSub=b()}("object"==typeof window&&window||this,function(){"use strict";function a(a){return function(){throw a}}function b(b,c,d){try{b(c,d)}catch(e){setTimeout(a(e),0)}}function c(a,b,c){a(b,c)}function d(a,d,e,f){var g,h=i[d],j=f?c:b;if(i.hasOwnProperty(d))for(g=0;g<h.length;g++)j(h[g].func,a,e)}function e(a,b,c){return function(){var e=String(a),f=e.lastIndexOf(".");for(d(a,a,b,c);-1!==f;)e=e.substr(0,f),f=e.lastIndexOf("."),d(a,e,b)}}function f(a){for(var b=String(a),c=i.hasOwnProperty(b),d=b.lastIndexOf(".");!c&&-1!==d;)b=b.substr(0,d),d=b.lastIndexOf("."),c=i.hasOwnProperty(b);return c&&i[b].length>0}function g(a,b,c,d){var g=e(a,b,d),h=f(a);return h?(c===!0?g():setTimeout(g,0),!0):!1}var h={},i={},j=-1;return h.publish=function(a,b){return g(a,b,!1,h.immediateExceptions)},h.publishSync=function(a,b){return g(a,b,!0,h.immediateExceptions)},h.subscribe=function(a,b){if("function"!=typeof b)return!1;i.hasOwnProperty(a)||(i[a]=[]);var c=String(++j);return i[a].push({token:c,func:b}),c},h.unsubscribe=function(a){var b,c,d="string"==typeof a,e=d?"token":"func",f=d?a:!0,g=!1;for(b in i)if(i.hasOwnProperty(b))for(c=i[b].length-1;c>=0;c--)if(i[b][c][e]===a&&(i[b].splice(c,1),g=f,d))return g;return g},h}),_.mixin(new function(){var a={},b={};this.globals=function(){var c=_(arguments).toArray();if(0===c.length)return a;if(1===c.length)return a[arguments[0]];if(c.length%2===0)for(var d=0;d<c.length/2;d+=2){var e=c[d],f=c[d+1];!!e!=!1&&(b[e]=f,Object.defineProperty(a,c[d],{get:function(){return b[e]},set:function(){}}))}},this.deleteGlobals=function(){var c=_(arguments).toArray();_(c).map(function(d,e){var f=c[e];delete b[f],delete a[f]})}}),_.mixin(new function(){this.publish=PubSub.publish,this.publishOnce=PubSub.publishOnce,this.publishSync=PubSub.publishSync,this.subscribe=PubSub.subscribe,this.unsubscribe=PubSub.unsubscribe}),_.mixin(new function(){var a,b=function(a){var b=_(a).toArray();if(b.length<2)throw new Error("Incorrect number of arguments. You must supply [Key, Value] plus a callback context");var c=_(b).last();if("function"!=typeof c)throw new Error("You must supply a callback function as last argument.");return{callback:c,items:_(b).initial()}},c={local:_.once(function(){if(a=window.localStorage,!!a==!1)throw new Error("Local Storage not found!")}),session:_.once(function(){return a=window.sessionStorage,!!a==!1?this.fallback.apply(this,arguments):void 0}),fallback:_.once(function(){return{setItem:function(a,b){var c=JSON.parse(window.name||"{}");c[a]=b,window.name=JSON.stringify(c)},getItem:function(a){var b=JSON.parse(window.name||"{}");return b[a]}}})};this.setData=function(){for(var c=b(arguments),d=0;d<c.items.length;d+=2)if(!!c.items[d]!=!1){var e=c.items[d],f=JSON.stringify(c.items[d+1]);a.setItem(e,f)}_(c.callback).delay(1,this)},this.getData=function(){var c=b(arguments),d=_(c.items).map(function(b){var c=a.getItem(b);return!!c==!1||"undefined"==c||"null"==c?null:JSON.parse(c)});return _(c.callback).delay(1,this,d),d},this.local=function(){return c.local(),this},this.session=function(){return c.session(),this}}),angular.module("underscore",[]).factory("_",function(){return window._});